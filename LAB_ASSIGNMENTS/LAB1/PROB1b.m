m = [412.09 0.00000 0.00000;
405.63 0.05390 0.20390;
403.16 0.07920 0.27740;
399.51 0.11530 0.36440;
394.91 0.16590 0.48480;
392.01 0.19100 0.54500;
385.91 0.27100 0.66200;
381.13 0.34800 0.72900;
376.69 0.40500 0.78600;
372.02 0.49300 0.84000;
369.88 0.53700 0.86700;
367.92 0.57900 0.89000;
366.62 0.60700 0.91100;
363.48 0.68400 0.92800;
360.74 0.74800 0.95200;
359.12 0.80900 0.96500;
358.44 0.82300 0.96900;
357.60 0.85300 0.98100;
356.91 0.87300 0.98600;
353.25 1.00000 1.00000];

tex=m(:,1);
x=m(:,2);
yex=m(:,3);

y=zeros(1,20);
t=zeros(1,20);
tdash=zeros(1,20);
t1=412.09;
t2=353.25;
pgiven=101.33;

for i=1:20
    t(i)=x(i)*t1+(1-x(i))*t2;
    p1=0.133322*(10^(6.87987-(1196.76/(219.161+t(i)-273))));
    p2=0.133322*(10^(6.99053-(1453.430/(215.310+t(i)-273))));
    p=p1*x(i)+p2*(1-x(i));
    while(abs(p-pgiven)/pgiven > 0.001)
        if(p < pgiven)
            t(i)=t(i)+0.01;
        else
            t(i)=t(i)-0.01;
        end
        p1=0.133322*(10^(6.87987-(1196.76/(219.161+t(i)-273))));
        p2=0.133322*(10^(6.99053-(1453.430/(215.310+t(i)-273))));
        p=p1*x(i)+p2*(1-x(i));
    end
    y(i)=x(i)*p1/(x(i)*p1+(1-x(i))*p2);
    tdash(i)=abs(t(i)-tex(i));
end


figure
plot(x,t);
hold on;
plot(y,t);
plot(x,tex,'-ro');
plot(yex,tex,'-bx');
xlabel('x,y');
ylabel('Temperature(K)');
legend('x-cal','y-calc','x-exp','y-exp');
hold off;


figure
plot(x,y);
hold on;
plot(x,yex,'-ro');
xlabel('x');
ylabel('y');
legend('y-calc','y-exp');
hold off;

figure
plot(x,tdash);
xlabel('x,y');
ylabel('|Texp-Tcal| (K)');