m=[13.703 0.00000 0.00000
13.982 0.00620 0.02540;
14.840 0.02410 0.09910;
15.147 0.02970 0.12100;
16.471 0.05420 0.21540;
16.775 0.05940 0.23430;
19.766 0.11090 0.38850;
23.678 0.17300 0.53040;
27.422 0.23610 0.62070;
30.006 0.28730 0.67470;
30.563 0.30140 0.68700;
31.531 0.32270 0.70090;
33.783 0.38450 0.73700;
34.035 0.39220 0.74120;
35.684 0.43840 0.76460;
36.536 0.48270 0.77970;
38.923 0.61850 0.81810;
39.587 0.67830 0.83270;
40.403 0.77460 0.85540;
40.715 0.82650 0.86980;
40.679 0.84230 0.87520;
40.830 0.84830 0.87830;
40.803 0.93150 0.91610;
40.646 0.95600 0.93630;
40.553 0.95860 0.93850;
40.489 0.96000 0.94030;
40.518 0.96160 0.94140;
39.345 1.00000 1.00000];

pex=m(:,1);
x=m(:,2);
yex=m(:,3);
t=308.15;
p1=antoine(6.9546,1170.966,226.232,t);
p2=antoine(8.11220,1592.864,226.1842,t);
y=zeros(1,14);
p=zeros(1,14);
pdash=zeros(1,14);

cg12=(58.68/80.67)*exp(-(-268.7676/(1.98709369025*t)));
cg21=(80.67/58.68)*exp(-(1270.3897/(1.98709369025*t)));

for i=1:1:28
    x1=x(i);
    x2=(1-x(i));
    
    g1=exp(-log(x1+cg12*x2)+x2*(cg12/(x1+(cg12*x2))-cg21/(x2+(cg21*x1))));
    g2=exp(-log(x2+cg21*x1)-x1*(cg12/(x1+(cg12*x2))-cg21/(x2+(cg21*x1))));
    p(i)=(x1*g1*p1)+(x2*g2*p2);
    y(i)=(x1*g1*p1)/p(i);
    pdash(i)=abs(p(i)-pex(i));
end
figure
plot(x,p);
hold on;
plot(y,p);
plot(x,pex,'-ro');
plot(yex,pex,'-bx');
xlabel('x,y');
ylabel('pressure(kPa)');
legend('x-cal','y-calc','x-exp','y-exp');
hold off;



figure
plot(x,y);
hold on;
plot(x,yex);
xlabel('x');
ylabel('y');
legend('y-calc','y-exp');
hold off;

figure
plot(x,pdash);
xlabel('x,y');
ylabel('|Pcal-Pexp| (kPa)');